<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.18"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Portapack-Carnage: UART Interrupt control</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Portapack-Carnage
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.18 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">UART Interrupt control<div class="ingroups"><a class="el" href="group__LM4Fxx.html">LM4F</a> &raquo; <a class="el" href="group__uart__file.html">UART</a></div></div>  </div>
</div><!--header-->
<div class="contents">

<p><b>Configuring interrupts from the <a class="el" href="structUART.html">UART</a></b>  
<a href="#details">More...</a></p>
<div class="dynheader">
Collaboration diagram for UART Interrupt control:</div>
<div class="dyncontent">
<div class="center"><img src="group__uart__irq.png" border="0" usemap="#group____uart____irq" alt=""/></div>
<map name="group____uart____irq" id="group____uart____irq">
<area shape="rect" href="group__uart__file.html" title="libopencm3 LM4F Universal Asynchronous Receiver Transmitter" alt="" coords="5,5,64,31"/>
<area shape="rect" title="Configuring interrupts from the UART" alt="" coords="112,5,279,31"/>
</map>
</div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ga20cf32aae3969a9b1e857cd1ca145a27"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__uart__irq_ga20cf32aae3969a9b1e857cd1ca145a27.html#ga20cf32aae3969a9b1e857cd1ca145a27">uart_enable_interrupts</a> (uint32_t uart, enum <a class="el" href="group__uart__defines_gad02c1455d23262a6dbda84d6053d1f7e.html#gad02c1455d23262a6dbda84d6053d1f7e">uart_interrupt_flag</a> ints)</td></tr>
<tr class="memdesc:ga20cf32aae3969a9b1e857cd1ca145a27"><td class="mdescLeft">&#160;</td><td class="mdescRight">Enable Specific <a class="el" href="structUART.html">UART</a> Interrupts.  <a href="group__uart__irq_ga20cf32aae3969a9b1e857cd1ca145a27.html#ga20cf32aae3969a9b1e857cd1ca145a27">More...</a><br /></td></tr>
<tr class="separator:ga20cf32aae3969a9b1e857cd1ca145a27"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga2fdf35d91a90e2452368b0358d942f93"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__uart__irq_ga2fdf35d91a90e2452368b0358d942f93.html#ga2fdf35d91a90e2452368b0358d942f93">uart_disable_interrupts</a> (uint32_t uart, enum <a class="el" href="group__uart__defines_gad02c1455d23262a6dbda84d6053d1f7e.html#gad02c1455d23262a6dbda84d6053d1f7e">uart_interrupt_flag</a> ints)</td></tr>
<tr class="memdesc:ga2fdf35d91a90e2452368b0358d942f93"><td class="mdescLeft">&#160;</td><td class="mdescRight">Enable Specific <a class="el" href="structUART.html">UART</a> Interrupts.  <a href="group__uart__irq_ga2fdf35d91a90e2452368b0358d942f93.html#ga2fdf35d91a90e2452368b0358d942f93">More...</a><br /></td></tr>
<tr class="separator:ga2fdf35d91a90e2452368b0358d942f93"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gac40fe4cd2b2d331d83100e305c2f6f78"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__uart__irq_gac40fe4cd2b2d331d83100e305c2f6f78.html#gac40fe4cd2b2d331d83100e305c2f6f78">uart_enable_rx_interrupt</a> (uint32_t uart)</td></tr>
<tr class="memdesc:gac40fe4cd2b2d331d83100e305c2f6f78"><td class="mdescLeft">&#160;</td><td class="mdescRight">Enable the <a class="el" href="structUART.html">UART</a> Receive Interrupt.  <a href="group__uart__irq_gac40fe4cd2b2d331d83100e305c2f6f78.html#gac40fe4cd2b2d331d83100e305c2f6f78">More...</a><br /></td></tr>
<tr class="separator:gac40fe4cd2b2d331d83100e305c2f6f78"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga6c46b4228c1da4010f8e8d5a66bde0c0"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__uart__irq_ga6c46b4228c1da4010f8e8d5a66bde0c0.html#ga6c46b4228c1da4010f8e8d5a66bde0c0">uart_disable_rx_interrupt</a> (uint32_t uart)</td></tr>
<tr class="memdesc:ga6c46b4228c1da4010f8e8d5a66bde0c0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Disable the <a class="el" href="structUART.html">UART</a> Receive Interrupt.  <a href="group__uart__irq_ga6c46b4228c1da4010f8e8d5a66bde0c0.html#ga6c46b4228c1da4010f8e8d5a66bde0c0">More...</a><br /></td></tr>
<tr class="separator:ga6c46b4228c1da4010f8e8d5a66bde0c0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaab2f52c4fdb9b8ba9e89670e93727ecf"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__uart__irq_gaab2f52c4fdb9b8ba9e89670e93727ecf.html#gaab2f52c4fdb9b8ba9e89670e93727ecf">uart_enable_tx_interrupt</a> (uint32_t uart)</td></tr>
<tr class="memdesc:gaab2f52c4fdb9b8ba9e89670e93727ecf"><td class="mdescLeft">&#160;</td><td class="mdescRight">Enable the <a class="el" href="structUART.html">UART</a> Transmit Interrupt.  <a href="group__uart__irq_gaab2f52c4fdb9b8ba9e89670e93727ecf.html#gaab2f52c4fdb9b8ba9e89670e93727ecf">More...</a><br /></td></tr>
<tr class="separator:gaab2f52c4fdb9b8ba9e89670e93727ecf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga2d6559da0d940412e88374af5fe8a5dc"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__uart__irq_ga2d6559da0d940412e88374af5fe8a5dc.html#ga2d6559da0d940412e88374af5fe8a5dc">uart_disable_tx_interrupt</a> (uint32_t uart)</td></tr>
<tr class="memdesc:ga2d6559da0d940412e88374af5fe8a5dc"><td class="mdescLeft">&#160;</td><td class="mdescRight">Disable the <a class="el" href="structUART.html">UART</a> Transmit Interrupt.  <a href="group__uart__irq_ga2d6559da0d940412e88374af5fe8a5dc.html#ga2d6559da0d940412e88374af5fe8a5dc">More...</a><br /></td></tr>
<tr class="separator:ga2d6559da0d940412e88374af5fe8a5dc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gab5fd7ee81bc609e4aca33a4b9079611b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__uart__irq_gab5fd7ee81bc609e4aca33a4b9079611b.html#gab5fd7ee81bc609e4aca33a4b9079611b">uart_clear_interrupt_flag</a> (uint32_t uart, enum <a class="el" href="group__uart__defines_gad02c1455d23262a6dbda84d6053d1f7e.html#gad02c1455d23262a6dbda84d6053d1f7e">uart_interrupt_flag</a> ints)</td></tr>
<tr class="memdesc:gab5fd7ee81bc609e4aca33a4b9079611b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Mark interrupt as serviced.  <a href="group__uart__irq_gab5fd7ee81bc609e4aca33a4b9079611b.html#gab5fd7ee81bc609e4aca33a4b9079611b">More...</a><br /></td></tr>
<tr class="separator:gab5fd7ee81bc609e4aca33a4b9079611b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga6271114e5fe89f29dd5243c7c0c1934d"><td class="memItemLeft" align="right" valign="top">static bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__uart__irq_ga6271114e5fe89f29dd5243c7c0c1934d.html#ga6271114e5fe89f29dd5243c7c0c1934d">uart_is_interrupt_source</a> (uint32_t uart, enum <a class="el" href="group__uart__defines_gad02c1455d23262a6dbda84d6053d1f7e.html#gad02c1455d23262a6dbda84d6053d1f7e">uart_interrupt_flag</a> source)</td></tr>
<tr class="memdesc:ga6271114e5fe89f29dd5243c7c0c1934d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Determine if interrupt is generated by the given source.  <a href="group__uart__irq_ga6271114e5fe89f29dd5243c7c0c1934d.html#ga6271114e5fe89f29dd5243c7c0c1934d">More...</a><br /></td></tr>
<tr class="separator:ga6271114e5fe89f29dd5243c7c0c1934d"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<p><b>Configuring interrupts from the <a class="el" href="structUART.html">UART</a></b> </p>
<p>To have an event generate an interrupt, its interrupt source must be unmasked. This can be achieved with <a class="el" href="group__uart__defines_ga20cf32aae3969a9b1e857cd1ca145a27.html#ga20cf32aae3969a9b1e857cd1ca145a27">uart_enable_interrupts()</a>. Interrupts which are no longer needed can be disabled through <a class="el" href="group__uart__defines_ga2fdf35d91a90e2452368b0358d942f93.html#ga2fdf35d91a90e2452368b0358d942f93">uart_disable_interrupts()</a>.</p>
<p>In order for the interrupt to generate an IRQ and a call to the interrupt service routine, the interrupt for the target <a class="el" href="structUART.html">UART</a> must be routed through the NVIC with <a class="el" href="group__CM3__nvic__defines_ga8feba3782b3c6c173969f6ddcee3cfb6.html#ga8feba3782b3c6c173969f6ddcee3cfb6">nvic_enable_irq()</a>. For this last step, the nvic.h header is needed: </p><div class="fragment"><div class="line"><span class="preprocessor">#include &lt;libopencm3/lm4f/nvic.h&gt;</span></div>
</div><!-- fragment --><p>Enabling an interrupt is as simple as unmasking the desired interrupt, and routing the desired <a class="el" href="structUART.html">UART</a>'s interrupt through the NVIC. </p><div class="fragment"><div class="line"><span class="comment">// Unmask receive interrupt</span></div>
<div class="line"><a class="code" href="group__uart__defines_gac40fe4cd2b2d331d83100e305c2f6f78.html#gac40fe4cd2b2d331d83100e305c2f6f78">uart_enable_rx_interrupt</a>(UART0);</div>
<div class="line"><span class="comment">// Make sure the interrupt is routed through the NVIC</span></div>
<div class="line"><a class="code" href="group__CM3__nvic__defines_ga8feba3782b3c6c173969f6ddcee3cfb6.html#ga8feba3782b3c6c173969f6ddcee3cfb6">nvic_enable_irq</a>(NVIC_UART0_IRQ);</div>
</div><!-- fragment --><p>If a more than one interrupt is to be enabled at one time, the interrupts can be enabled by a single call to <a class="el" href="group__uart__defines_ga20cf32aae3969a9b1e857cd1ca145a27.html#ga20cf32aae3969a9b1e857cd1ca145a27">uart_enable_interrupts()</a>. For example: </p><div class="fragment"><div class="line"><span class="comment">// Unmask receive, CTS, and RI, interrupts</span></div>
<div class="line"><a class="code" href="group__uart__defines_ga20cf32aae3969a9b1e857cd1ca145a27.html#ga20cf32aae3969a9b1e857cd1ca145a27">uart_enable_interrupts</a>(UART0, UART_INT_RX | UART_INT_RI | UART_INT_CTS);</div>
</div><!-- fragment --><p>After interrupts are properly enabled and routed through the NVIC, when an event occurs, the appropriate IRQ flag is set by hardware, and execution jumps to the <a class="el" href="structUART.html">UART</a> ISR. The ISR should query the IRQ flags to determine which event caused the interrupt. For this, use <a class="el" href="group__uart__irq_ga6271114e5fe89f29dd5243c7c0c1934d.html#ga6271114e5fe89f29dd5243c7c0c1934d">uart_is_interrupt_source()</a>, with the desired UART_INT flag. After one or more interrupt sources are serviced, the IRQ flags must be cleared by the ISR. This can be done with <a class="el" href="group__uart__defines_gab5fd7ee81bc609e4aca33a4b9079611b.html#gab5fd7ee81bc609e4aca33a4b9079611b">uart_clear_interrupt_flag()</a>.</p>
<p>A typical <a class="el" href="structUART.html">UART</a> ISR may look like the following: </p><div class="fragment"><div class="line"><span class="keywordtype">void</span> uart0_isr(<span class="keywordtype">void</span>)</div>
<div class="line">{</div>
<div class="line"> uint32_t serviced_irqs = 0;</div>
<div class="line"> </div>
<div class="line"> <span class="comment">// Process individual IRQs</span></div>
<div class="line"> <span class="keywordflow">if</span> (<a class="code" href="group__uart__irq_ga6271114e5fe89f29dd5243c7c0c1934d.html#ga6271114e5fe89f29dd5243c7c0c1934d">uart_is_interrupt_source</a>(UART0, UART_INT_RX)) {</div>
<div class="line">    process_rx_event();</div>
<div class="line">    serviced_irq |= UART_INT_RX;</div>
<div class="line"> }</div>
<div class="line"> <span class="keywordflow">if</span> (<a class="code" href="group__uart__irq_ga6271114e5fe89f29dd5243c7c0c1934d.html#ga6271114e5fe89f29dd5243c7c0c1934d">uart_is_interrupt_source</a>(UART0, UART_INT_CTS)) {</div>
<div class="line">    process_cts_event();</div>
<div class="line">    serviced_irq |= UART_INT_CTS;</div>
<div class="line"> }</div>
<div class="line"> </div>
<div class="line"> <span class="comment">// Clear the interupt flag for the processed IRQs</span></div>
<div class="line"> <a class="code" href="group__uart__defines_gab5fd7ee81bc609e4aca33a4b9079611b.html#gab5fd7ee81bc609e4aca33a4b9079611b">uart_clear_interrupt_flag</a>(UART0, serviced_irqs);</div>
<div class="line">}</div>
</div><!-- fragment --> </div><!-- contents -->
<div class="ttc" id="agroup__CM3__nvic__defines_ga8feba3782b3c6c173969f6ddcee3cfb6_html_ga8feba3782b3c6c173969f6ddcee3cfb6"><div class="ttname"><a href="group__CM3__nvic__defines_ga8feba3782b3c6c173969f6ddcee3cfb6.html#ga8feba3782b3c6c173969f6ddcee3cfb6">nvic_enable_irq</a></div><div class="ttdeci">BEGIN_DECLS void nvic_enable_irq(uint8_t irqn)</div><div class="ttdoc">NVIC Enable Interrupt.</div><div class="ttdef"><b>Definition:</b> nvic.c:57</div></div>
<div class="ttc" id="agroup__uart__defines_gab5fd7ee81bc609e4aca33a4b9079611b_html_gab5fd7ee81bc609e4aca33a4b9079611b"><div class="ttname"><a href="group__uart__defines_gab5fd7ee81bc609e4aca33a4b9079611b.html#gab5fd7ee81bc609e4aca33a4b9079611b">uart_clear_interrupt_flag</a></div><div class="ttdeci">void uart_clear_interrupt_flag(uint32_t uart, enum uart_interrupt_flag ints)</div><div class="ttdoc">Mark interrupt as serviced.</div><div class="ttdef"><b>Definition:</b> uart.c:508</div></div>
<div class="ttc" id="agroup__uart__defines_gac40fe4cd2b2d331d83100e305c2f6f78_html_gac40fe4cd2b2d331d83100e305c2f6f78"><div class="ttname"><a href="group__uart__defines_gac40fe4cd2b2d331d83100e305c2f6f78.html#gac40fe4cd2b2d331d83100e305c2f6f78">uart_enable_rx_interrupt</a></div><div class="ttdeci">void uart_enable_rx_interrupt(uint32_t uart)</div><div class="ttdoc">Enable the UART Receive Interrupt.</div><div class="ttdef"><b>Definition:</b> uart.c:459</div></div>
<div class="ttc" id="agroup__uart__defines_ga20cf32aae3969a9b1e857cd1ca145a27_html_ga20cf32aae3969a9b1e857cd1ca145a27"><div class="ttname"><a href="group__uart__defines_ga20cf32aae3969a9b1e857cd1ca145a27.html#ga20cf32aae3969a9b1e857cd1ca145a27">uart_enable_interrupts</a></div><div class="ttdeci">void uart_enable_interrupts(uint32_t uart, enum uart_interrupt_flag ints)</div><div class="ttdoc">Enable Specific UART Interrupts.</div><div class="ttdef"><b>Definition:</b> uart.c:430</div></div>
<div class="ttc" id="agroup__uart__irq_ga6271114e5fe89f29dd5243c7c0c1934d_html_ga6271114e5fe89f29dd5243c7c0c1934d"><div class="ttname"><a href="group__uart__irq_ga6271114e5fe89f29dd5243c7c0c1934d.html#ga6271114e5fe89f29dd5243c7c0c1934d">uart_is_interrupt_source</a></div><div class="ttdeci">static bool uart_is_interrupt_source(uint32_t uart, enum uart_interrupt_flag source)</div><div class="ttdoc">Determine if interrupt is generated by the given source.</div><div class="ttdef"><b>Definition:</b> uart.h:540</div></div>
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.18
</small></address>
</body>
</html>
