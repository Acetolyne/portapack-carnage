<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.18"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Portapack-Carnage: ADC Driver</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Portapack-Carnage
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.18 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">ADC Driver<div class="ingroups"><a class="el" href="group__IO.html">HAL</a></div></div>  </div>
</div><!--header-->
<div class="contents">

<p>Generic ADC Driver.  
<a href="#details">More...</a></p>
<div class="dynheader">
Collaboration diagram for ADC Driver:</div>
<div class="dyncontent">
<div class="center"><img src="group__ADC.png" border="0" usemap="#group____ADC" alt=""/></div>
<map name="group____ADC" id="group____ADC">
<area shape="rect" href="group__IO.html" title="Hardware Abstraction Layer." alt="" coords="5,5,53,31"/>
<area shape="rect" title="Generic ADC Driver." alt="" coords="101,5,196,31"/>
</map>
</div>
<p>Generic ADC Driver. </p>
<p>This module implements a generic ADC (Analog to Digital Converter) driver supporting a variety of buffer and conversion modes. </p><dl class="section pre"><dt>Precondition</dt><dd>In order to use the ADC driver the <code>HAL_USE_ADC</code> option must be enabled in <code>halconf.h</code>.</dd></dl>
<h1><a class="anchor" id="adc_1"></a>
Driver State Machine</h1>
<p>The driver implements a state machine internally, not all the driver functionalities can be used in any moment, any transition not explicitly shown in the following diagram has to be considered an error and shall be captured by an assertion (if enabled). </p><div class="dotgraph">
<img src="dot_inline_dotgraph_6.png" alt="dot_inline_dotgraph_6.png" border="0" usemap="#dot_inline_dotgraph_6.map"/>
</div>
<h1><a class="anchor" id="adc_2"></a>
ADC Operations</h1>
<p>The ADC driver is quite complex, an explanation of the terminology and of the operational details follows.</p>
<h2><a class="anchor" id="adc_2_1"></a>
ADC Conversion Groups</h2>
<p>The <code>ADCConversionGroup</code> is the objects that specifies a physical conversion operation. This structure contains some standard fields and several implementation-dependent fields.<br  />
 The standard fields define the CG mode, the number of channels belonging to the CG and the optional callbacks.<br  />
 The implementation-dependent fields specify the physical ADC operation mode, the analog channels belonging to the group and any other implementation-specific setting. Usually the extra fields just mirror the physical ADC registers, please refer to the vendor's MCU Reference Manual for details about the available settings. Details are also available into the documentation of the ADC low level drivers and in the various sample applications.</p>
<h2><a class="anchor" id="adc_2_2"></a>
ADC Conversion Modes</h2>
<p>The driver supports several conversion modes:</p><ul>
<li><b>One Shot</b>, the driver performs a single group conversion then stops.</li>
<li><b>Linear Buffer</b>, the driver performs a series of group conversions then stops. This mode is like a one shot conversion repeated N times, the buffer pointer increases after each conversion. The buffer is organized as an S(CG)*N samples matrix, when S(CG) is the conversion group size (number of channels) and N is the buffer depth (number of repeated conversions).</li>
<li><b>Circular Buffer</b>, much like the linear mode but the operation does not stop when the buffer is filled, it is automatically restarted with the buffer pointer wrapping back to the buffer base.</li>
</ul>
<h2><a class="anchor" id="adc_2_3"></a>
ADC Callbacks</h2>
<p>The driver is able to invoke callbacks during the conversion process. A callback is invoked when the operation has been completed or, in circular mode, when the buffer has been filled and the operation is restarted. In circular mode a callback is also invoked when the buffer is half filled.<br  />
 The "half filled" and "filled" callbacks in circular mode allow to implement "streaming processing" of the sampled data, while the driver is busy filling one half of the buffer the application can process the other half, this allows for continuous interleaved operations.</p>
<p>The driver is not thread safe for performance reasons, if you need to access the ADC bus from multiple threads then use the <code>adcAcquireBus()</code> and <code>adcReleaseBus()</code> APIs in order to gain exclusive access. </p>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.18
</small></address>
</body>
</html>
